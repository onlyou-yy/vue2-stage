{"version":3,"file":"vue.js","sources":["../src/utils.js","../src/globalAPI.js","../src/compiler/parse.js","../src/compiler/index.js","../src/observe/dep.js","../src/observe/watcher.js","../src/vdom/index.js","../src/lifecycle.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["/**合并选项 */\nexport function mergeOptions(parent,child){\n  const options = {};//定义一个新对象用来存储合并后的对象\n  //先合并父选项\n  for(let key in parent){\n    mergeField(key);\n  }\n  //再用子选项来覆盖和合并父选项\n  for(let key in child){\n    if(!parent.hasOwnProperty(key)){\n      mergeField(key);\n    }\n  }\n  function mergeField(key){\n    //采用策略模式减少 if/else\n    //如果不在策略中优先使用子\n    if(strats[key]){\n      options[key] = strats[key](parent[key],child[key]);\n    }else{\n      //优先使用子的，再使用父的\n      options[key] = child[key] || parent[key];\n    }\n  }\n  return options;\n}\n\n//策略模式\nconst strats = {};\nconst LIFECYCLE = [\n  'beforeCreate',\n  'created',\n  'beforeMount',\n  'mounted',\n  'beforeUpdate',\n  'updated',\n  'beforeDestroy',\n  'destroyed',\n];\nLIFECYCLE.forEach(hook => {\n  strats[hook] = function(p,c){\n    // 第一次合并：{} + {created:fn} => {created:[fn]}\n    // 第二次合并：{created:fn1} + {created:fn2} => {created:[fn1,fn2]}\n    if(c){\n      if(p){\n        // 父子都有\n        return p.concat(c);\n      }else{\n        // 只有子有,初始化过程\n        return [c];\n      }\n    }else{\n      // 如果子没有，就直接使用父的\n      // 只要经过初始化过程， 父 就已经是个数组\n      // 如 {created:[fn]} + {a:1}\n      return p;\n    }\n  }\n})","import { mergeOptions } from \"./utils\";\n\nexport function initGlobalAPI(Vue){\n  //Vue静态属性和方法\n  Vue.options = {};\n  Vue.mixin = function(mixin){\n    //将用户选项和全局的options合并\n    this.options = mergeOptions(this.options,mixin);\n    return this;\n  }\n}","/**\n * 一般解析html 都不会自己去写，可以使用第三方包，htmlparser2\n * 也可以在 https://astexplorer.net/ 感受 ast的转化\n */\n\n//可视化正则表达式 https://regexper.com\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`;//匹配标签名\n//?:代表不捕获分组,使用match后将不会?:的分组不会出现\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`;//匹配标签名和带命名空间的标签,如<namespace:div>\n//匹配开始标签\nconst startTagOpen = new RegExp(`^<${qnameCapture}`);//匹配到的分组是一个标签名 <div 匹配到的分组就是开始标签的名字\n//匹配结束标签\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`);//匹配的是 </xxx> 最终匹配到的分组就是结束标签的名字\n//匹配属性,第一个属性就是 key，value 就是 分组3/4/5\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>']+)))?/;\n//匹配闭合标签 > 或者 />\nconst startTagClose = /^\\s*(\\/?)>/;// /> <br/>\n\n\n//解析html,vue3并不是使用正则来进行匹配的\nexport function parseHTML(html){\n  const ELEMENT_TYPE = 1;\n  const TEXT_TYPE = 3;\n  const stack = [];//用来存放元素的栈\n  let currentParent;//指向栈顶元素\n  let root;//根节点\n  //----------------- 转成 ast -------------------\n  //创建ast元素\n  function createASTElement(tag,attrs){\n    return {\n      tag,\n      attrs,\n      type:ELEMENT_TYPE,\n      children:[],\n      parent:null\n    }\n  }\n  //获取开始标签回调\n  function start(tag,attrs){\n    let node = createASTElement(tag,attrs);\n    if(!root){//如果还没有根节点，当前ast节点就是根节点\n      root = node;\n    }\n    if(currentParent){\n      node.parent = currentParent;\n      currentParent.children.push(node);\n    }\n    stack.push(node);\n    currentParent = node;\n  }\n  //获取标签中内容回调\n  function chars(text){\n    text = text.replace(/\\s/g,'');\n    // 文本直接放到当前节点中\n    text && currentParent.children.push({\n      type:TEXT_TYPE,\n      text,\n      parent:currentParent\n    })\n  }\n  //获取结束标签回调\n  function end(tag){\n    stack.pop();//每次遇到结束标签都进行出栈操作\n    currentParent = stack[stack.length - 1];//重新指向栈顶\n  }\n  //----------------- 转成 ast -------------------\n\n  //截取内容\n  function advance(length){\n    html = html.substring(length);\n  }\n  //匹配解析开始标签\n  function parseStartTag(){\n    const start = html.match(startTagOpen);\n    if(start){\n      // 是开始标签\n      const match = {\n        tagName:start[1],//标签名\n        attrs:[],\n      }\n      //每次匹配成功都将成功的部分删除掉，然后继续匹配，这样就不会重复匹配之前的\n      advance(start[0].length);\n\n      //如果不是开始标签的结束就一直匹配下去\n      let attr,end;\n      while(!(end = html.match(startTagClose)) && (attr = html.match(attribute))){\n        //删除长度\n        advance(attr[0].length);\n        //保存属性\n        match.attrs.push({name:attr[1],value:attr[3]||attr[4]||attr[5]||true})\n      }\n      //匹配完成后，如果有 开始标签的结束 就把结束也删除\n      if(end){\n        advance(end[0].length);\n      }\n      return match;\n    }\n    //不是开始标签\n    return false;\n  }\n  //html 最开始肯定是一个 <\n  while(html){\n    let textEnd = html.indexOf(\"<\");\n    //如果textEnd是0 表示 是标签，如<div id=\"app\">{{name}}</div>\n    //可能是开始标签，一开始的时候是开始标签 <div id=\"app\">\n    //也可能是结束标签，\n    //  因为每次匹配到内容都会把响应的内容删除掉，\n    //  所以在匹配到开始标签之后textEnd > 0 再匹配到文本，最后就剩下 </div>\n    if(textEnd === 0){\n      //开始标签的匹配结果\n      const startTagMatch = parseStartTag();\n      if(startTagMatch){\n        //抛出数据，生成ast\n        start(startTagMatch.tagName,startTagMatch.attrs);\n        continue;\n      }\n\n      //结束标签的匹配结果\n      const endTagMatch = html.match(endTag);\n      if(endTagMatch){\n        //抛出数据，生成ast\n        end(endTagMatch[1]);\n        advance(endTagMatch[0].length);\n        continue;\n      }\n    }\n    //如果 textEnd > 0 就是文本的结束位置\n    if(textEnd > 0){\n      //标签中的内容\n      let text = html.substring(0,textEnd);\n      if(text){\n        //抛出数据，生成ast\n        chars(text);\n        advance(text.length);\n      }\n    }\n  }\n  return root;\n}","import { parseHTML } from \"./parse\";\n\n/**生成属性代码 */\nfunction genProps(attrs){\n  let str = '';\n  for(let i = 0;i < attrs.length;i++){\n    let attr = attrs[i];\n    if(attr.name == 'style'){\n      //如果是 style 就将值转换成对象,color:red;background:red -> {color:'red',background:'red'}\n      let obj = {};\n      attr.value.split(';').forEach(item=>{\n        let [key,value] = item.split(':');\n        obj[key] = value;\n      })\n      attr.value = obj;\n    }\n    str += `${attr.name}:${JSON.stringify(attr.value)},`;\n  }\n  return `{${str.slice(0,-1)}}`;//去除最后一个 ,\n}\n\n//匹配表达式变量\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;//{{ xxx }}\n/**生成节点代码 */\nfunction gen(node){\n  if(node.type === 1){\n    //标签节点\n    return codegen(node);\n  }else{\n    //文本\n    let text = node.text;\n    if(defaultTagRE.test(text)){\n      //带模版语法的文本 {{name}} hello {{age}} world\n      let token = [];\n      //捕获匹配到的值\n      let match;\n      //因为正则表达式中的 g，\n      //在匹配的时候会把上一次匹配到的字符串的最后一个字符的索引用lastIndex保存，\n      //无论是 .test 还是 .match .exec 都会记录\n      //下次就会从lastIndex的位置开始匹配，\n      //有三种方式可以重置开始位置，1:重新设置 reg.lastIndex = 0 2:重新赋值表达式 reg = // 3:重新编译表达式 reg.compile()\n      defaultTagRE.lastIndex = 0;\n      let lastIndex = 0;//上次匹配到的位置\n      while(match = defaultTagRE.exec(text)){\n        let index = match.index;//当前匹配到的位置\n        if(index > lastIndex){\n          //如果上次匹配到的位置小于当前位置就把中间的这段内容也放进去\n          token.push(JSON.stringify(text.slice(lastIndex,index)));\n        }\n        token.push(`_s(${match[1].trim()})`);\n        lastIndex = index + match[0].length;\n      }\n      if(lastIndex < text.length){\n        token.push(JSON.stringify(text.slice(lastIndex)));\n      }\n      return `_v(${token.join('+')})`;\n    }else{\n      //普通纯文本\n      return `_v('${text}')`;\n    }\n  }\n}\n/**生成children代码 */\nfunction genChildren(children){\n  return children.map(child => gen(child)).join(',');\n}\n\n/*生成渲染函数代码 */\nfunction codegen(ast){\n  let children = genChildren(ast.children);\n  let code = (\n    `_c(\n      '${ast.tag}',\n      ${ast.attrs.length > 0 ? genProps(ast.attrs): 'null'}\n      ${ast.children.length ? `,${children}`:''}\n    )`\n  );\n  return code;\n}\n\n/**编译模版形成渲染函数 */\nexport function compileToFunction(template){\n  // 1将template 转化成 ast 语法树\n  let ast = parseHTML(template);\n  // 2生成 render方法（render）,是用with指定执行上下文\n  // 模版引擎的原理就是 with + new Function(code)\n  let code = `with(this){return ${codegen(ast)};}`;\n  // 根据代码生成函数\n  let render = new Function(code);\n  return render;\n}","let id = 0;\nclass Dep{\n  constructor(){\n    this.id = id++;\n    // 属性的dep 需要收集 watcher\n    // 存放当前属性对应的watcher有哪些\n    this.subs = [];\n  }\n  depend(){\n    Dep.target.addDep(this);//让watcher记住dep\n  }\n  addSub(watcher){\n    this.subs.push(watcher);\n  }\n  /**通知watcher进行更新 */\n  notify(){\n    this.subs.forEach(watcher => watcher.update());\n  }\n}\n\n//添加一个静态属性，用来存放临时的 watcher\n//当 watcher 调用 get() 方法进行渲染的时候会去vm上取值，\n//取值的时候就会触发数据劫持的 get ，此时就可以将这个watcher进行收集了\nDep.target = null;\n\n/**watcher栈 */\nlet stack = [];\nexport function pushTarget(watcher){\n  stack.push(watcher);\n  Dep.target = watcher;\n}\nexport function popTarget(watcher){\n  stack.pop();\n  Dep.target = stack[stack.length - 1];\n}\n\nexport default Dep;","/**\n * 每一个组件都有一个watcher\n * 这样可以做的局部更新\n */\n\nimport Dep, { popTarget, pushTarget } from \"./dep\";\n\nlet id = 0;\n\n// dep 和 watcher 就是观察者模式\n// 每个属性有一个 dep（属性就是被观察者），watcher就是观察者（属性变化了会通知观察者更新）\n\n// 需要给每个属性都增加一个dep,目的就是收集watcher\n// 一个组件中有多个属性（n个属性会对应一个视图）n个dep对应一个watcher\n// 1个属性也可以被多个组件使用，所以 1个dep对应多个watcher\n// 所以 dep 和 watcher 是 多对多的关系\n\n//当我们创建渲染watcher的时候我们就会把当前的渲染watcher放到Dep.target上\n//调用 _render() 会取值，触发属性的 get\nclass Watcher{\n  /**\n   * @param vm 组件实例\n   * @param fn 更新组件的方法\n   * @param options 是否是一个渲染watcher\n   */\n  constructor(vm,fn,options){\n    //id 用来区分每个组件的watcher\n    this.id = id++;\n    //是否是一个渲染watcher\n    this.renderWatcher = options;\n    //getter 意味着调用这个函数可以发生取值操作,也就是收集依赖\n    this.getter = fn;\n    // 后续实现计算属性和一些清楚工作的时候需要用到dep\n    // 比如说某个组件卸载了，需要再dep中移除当前watcher\n    // 所以再这里还需要将dep也记录收集一下\n    this.deps = [];\n    this.depsId = new Set();\n    //初始的时候调用一下 getter\n    this.get();\n  }\n  get(){\n    pushTarget(this);//缓存当前 watcher 实例\n    this.getter();//会去vm上取值\n    popTarget();//重新出栈\n  }\n  addDep(dep){\n    // 一个组件 watcher 中，可能会使用多个重复的属性，重复的属性不需要记录\n    let id = dep.id;\n    if(!this.depsId.has(id)){\n      this.deps.push(dep); //watcher记录dep\n      this.depsId.add(id);\n      dep.addSub(this);//dep记录watcher\n    }\n  }\n  /**重新更新 */\n  update(){\n    // this.get();\n    // 异步更新先将当前 watcher 暂存起来\n    queueWatcher(this);\n  }\n  run(){\n    this.get();\n  }\n}\n\n/**刷新执行队列命令 */\nfunction flushSchedulerQueue(){\n  // 在刷新的过程中可能还有新的watcher加入，重新放到queue中，所以先复制一份queue\n  let flushQueue = queue.slice(0);\n  queue = [];\n  has = {};\n  pending = false;\n  flushQueue.forEach(q => q.run());\n}\n\nlet queue = [];\nlet has = {};\nlet pending = false;//防抖\n/**缓存watcher */\nfunction queueWatcher(watcher){\n  let id = watcher.id;\n  if(!has[id]){\n    queue.push(watcher);\n    has[id] = true;\n    \n    if(!pending){\n      nextTick(flushSchedulerQueue, 0);\n      pending = true;\n    }\n  }\n}\n\n\n/**执行nextTick队列任务 */\nfunction flushCallbacks(){\n  let cbs = callbacks.slice(0);\n  callbacks = [];\n  waiting = false;\n  cbs.forEach(cb => cb());\n}\n\nlet callbacks = [];\nlet waiting = false;\n/**\n * 异步更新回调\n * nextTick 不是创建了一个异步任务，而是将这个任务维护到了队列中而已\n */\nexport function nextTick(cb){\n  callbacks.push(cb);\n  if(!waiting){\n    //创建异步任务的时候，在vue2中，并没有直接使用某个API，而是使用优雅降级的方式\n    //（vue3中因为已经不在兼容ie了，所以直接采用了promise）\n    //内部先采用优先顺序是： \n    // promise（ie不兼容）\n    // MutationObserver（H5新接口，只能在浏览器中使用）\n    // setImmediate（ie专享）\n    // setTimeout\n    // setTimeout(()=>{flushCallbacks();},0);\n    timerFunc();\n    waiting = true;\n  }\n}\n\n/**异步任务适配 */\nlet timerFunc;\nif(Promise){\n  timerFunc = () => {\n    Promise.resolve().then(flushCallbacks);\n  }\n}else if(MutationObserver){\n  let observer = MutationObserver(flushCallbacks);\n  let textNode = document.createTextNode(1);\n  observer.observe(textNode,{\n    characterData:true\n  });\n  timerFunc = () => {\n    textNode.textContent = 2\n  }\n}else if(setImmediate){\n  timerFunc = () => {\n    setImmediate(flushCallbacks);\n  }\n}else if(setImmediate){\n  timerFunc = () => {\n    setTimeout(flushCallbacks,0);\n  }\n}\n\nexport default Watcher;","/**生成虚拟节点，也就是vue中的 h(), _c() */\nexport function createElementVNode(vm,tag,data,...children){\n  if(data == null) data = {};\n  let key = data.key;\n  if(key){\n    delete data.key;\n  }\n  return vnode(vm,tag,key,data,children);\n}\n\n/**生成文本虚拟节点，_v() */\nexport function createTextVNode(vm,text){\n  return vnode(vm,undefined,undefined,undefined,undefined,text);\n}\n\n/**\n * 创建虚拟节点\n * ast做的事语法层面的转化，\n * vnode描述的DOM元素，可以增加一些自定义的属性\n */\nfunction vnode(vm,tag,key,data,children,text){\n  return {\n    vm,\n    tag,\n    key,\n    data,\n    children,\n    text\n  }\n}","import Watcher from \"./observe/watcher\";\nimport { createElementVNode, createTextVNode } from \"./vdom\"\n\n/**创建真实DOM */\nfunction createElm(vnode){\n  let {tag,data,children,text} = vnode;\n  if(typeof tag === 'string'){\n    //标签\n    //将真实DOM挂载到虚拟DOM上，方便后续修改属性\n    vnode.el = document.createElement(tag);\n    // 设置属性\n    patchProps(vnode.el,data);\n    // 添加子节点\n    children.forEach(child => {\n      vnode.el.appendChild(createElm(child));\n    })\n  }else{\n    //tag为undefined就是个文本节点\n    vnode.el = document.createTextNode(text);\n  }\n  return vnode.el;\n}\n\n/**更新和初始化真实DOM的属性 */\nfunction patchProps(el,props){\n  for(let key in props){\n    if(key === 'style'){//值是 [{color:'red'}]\n      for(let styleName in props.style){\n        el.style[styleName] = props.style[styleName];\n      }\n    }else{\n      el.setAttribute(key,props[key]);\n    }\n  }\n}\n\n/**初始化和更新DOM */\nfunction patch(oldNode,vnode){\n  console.log(vnode);\n  //真实DOM中才有nodeType\n  const isRealElement = oldNode.nodeType;\n  if(isRealElement){\n    //是真实DOM，进行初始化挂载\n    let elm = oldNode;//当前节点\n    let parentElm = elm.parentNode;\n    //创建真实DOM\n    let newElm = createElm(vnode);\n    //先在原来的后面添加节点，然后再删除老节点\n    parentElm.insertBefore(newElm,elm.nextSibiling);//添加新节点\n    parentElm.removeChild(elm);//删除老节点\n    return newElm;\n  }else{\n    //diff 算法，对比两个虚拟DOM\n  }\n}\n\nexport function initLifeCycle(Vue){\n  /**将虚拟DOM转化成真实DOM */\n  Vue.prototype._update = function(vnode){\n    const vm = this;\n    const el = vm.$el;\n    //patch 既有初始化的功能，又有更新的方法\n    vm.$el = patch(el,vnode);\n  }\n  /**生成虚拟节点 */\n  Vue.prototype._c = function(){\n    return createElementVNode(this,...arguments);\n  }\n  /**生成文本虚拟节点 */\n  Vue.prototype._v = function(){\n    return createTextVNode(this,...arguments);\n  }\n  /**生成虚拟DOM */\n  Vue.prototype._s = function(value){\n    if(typeof value !== 'object') return value;\n    return JSON.stringify(value);\n  }\n  /**生成虚拟DOM */\n  Vue.prototype._render = function(){\n   const vm = this;\n   //当渲染的时候回去实例中取值，就可以将属性和视图绑定在一起了\n   return vm.$options.render.call(vm);//通过ast语法转义后生成的render方法\n  }\n}\n\n/**将组件挂载到DOM上 */\nexport function mountComponent(vm,el){\n  // 将节点挂载到实例上，方便之后访问\n  vm.$el = el;\n  // 1.调用render方法产生虚拟节点，虚拟DOM\n  const updateComponent = () => {\n    vm._update(vm._render());\n  }\n\n  new Watcher(vm,updateComponent);\n  \n\n  // 2.根据虚拟DOM产生真实DOM\n\n  // 3.插入到el元素中\n\n}\n\n/**\n * vue核心流程\n * 1.创造响应式数据\n * 2.模版转换成ast语法树\n * 3.将ast语法树转换成了render函数\n * 4.后续每次数据更新可以只执行render函数（无需再次执行ast转化的过程）\n */\n\n// render 函数会去产生虚拟节点（使用响应式数据）\n// 根据生成的虚拟节点创造正式的DOM\n\n// ---------------------------------------------------------------------\n\n/**调用选项中的生命钩子函数 */\nexport function callHook(vm,hook){\n  const handlers = vm.$options[hook];\n  if(handlers){\n    handlers.forEach(handler => handler.call(vm));\n  }\n}\n","// 重写数组中的部分方法\nlet oldArrayProto = Array.prototype;\n// 先复制一份原型\nexport let newArrayProto = Object.create(oldArrayProto);\n\n//列举出所有需要重新的方法\nlet methods = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'sort',\n  'reverse',\n  'splice'\n];\n\n// 开始重新方法\nmethods.forEach(item => {\n  //重写方法\n  newArrayProto[item] = function(...args){\n    // 内部还是调用原来的方法\n    const result = oldArrayProto[item].call(this,...args);\n    // 当新增数据时，还需要对新数据进行观察\n    let inserted;\n    let ob = this.__ob__;\n    switch(item){\n      case 'push':\n      case 'unshift':\n        inserted = args;\n        break;\n      case 'splice'://[1,2,3].splice(1,0,4,5);表示在2的位置插入 4，5\n        inserted = args.slice(2);\n        break;\n      default:\n        break;\n    }\n    if(inserted){\n      //对新增的数据进行观测\n      //这里唯一可以拿到的关联数据就是this，但是我们需要调用 Observer 中的 observeArray 来观察新数据\n      //而在创建 Observer 的时候又将 实例挂载到了 __ob__ 上，所以\n      ob.observeArray(inserted);\n    }\n\n    //数组变化了，通知对应的watcher实现更新\n    ob.dep.notify();\n    \n    return result;\n  }\n})","import { newArrayProto } from \"./array\";\nimport Dep from \"./dep\";\n\n/**通过 Object.defineProperty来劫持数据 */\nexport function observe(data){\n  //只能对对象进行劫持，所以要先进行判断\n  if(typeof data !== 'object' || data === null){\n    return;\n  }\n  //如果data 上有 __ob__ 并且是 Observer 时说明，这个对象已经被观测过了\n  if(data.__ob__ instanceof Observer){\n    return;\n  }\n\n  //如果一个对象已经被劫持过了，那就不用再被劫持\n  //（需要判断一个对象是否被劫持过，可以增添一个实例，用实例来判断是否被劫持过）\n  return new Observer(data);\n}\n\n/**观察者（被劫持对象） */\nclass Observer{\n  constructor(data){\n\n    //给每个对象都增加收集功能\n    this.dep = new Dep();\n\n    //Object.defineProperty只能劫持已经存在的属性（vue里面会为添加，删除属性的方法添加一些api，如$set,$delete）\n    \n    //将当前实例赋值给__ob__属性保存下来，方便在其他的地方调用实例的方法\n    //并且添加这个标识之后就可以知道这个数据已经被观察过了，不用在进行观察\n    // data.__ob__ = this;\n    //不过直接这样添加的话，在调用 this.walk(data) 的时候会形成死循环，可以这样解决\n    Object.defineProperty(data,\"__ob__\",{\n      value:this,\n      enumerable:false,//不可枚举，循环时就获取不了\n    })\n\n    if(Array.isArray(data)){\n      //当值为数组的也是可以对其进行劫持的，但是数组长度很长的时候就会非常消耗性能\n      //而且一般也不会通过索引来访问很设置值，所以vue中并不会劫持数组，而是重构数组的方法来实现响应式数据\n      data.__proto__ = newArrayProto;\n      //如果数组中的某个元素是对象的时候也是需要对其进行劫持的\n      this.observeArray(data);\n    }else{\n      this.walk(data);\n    }\n  }\n  walk(data){\n    //循环对象，对每个数据都进行劫持\n    //每次劫持都是一个重新定义属性的过程，所以会比较耗性能\n    Object.keys(data).forEach(key => {\n      defineReactive(data,key,data[key]);\n    })\n  }\n  observeArray(data){\n    data.forEach(item => observe(item));\n  }\n}\n\n/**重新定义属性 */\nexport function defineReactive(target,key,value){\n  //如果值是对象，那么还需要继续对数据进行劫持\n  let childOb = observe(value);//childOb.dep 用来收集依赖\n  //为每个属性创建一个dep,闭包中不会被销毁\n  let dep = new Dep();\n  //这里用到了 闭包 来保存 value 值。\n  Object.defineProperty(target,key,{\n    get(){\n      //取值时\n      if(Dep.target){//当进行普通的取值使用的时候不需要进行依赖收集\n        dep.depend();//让这个属性的收集器记住当前的watcher\n        if(childOb){\n          //让数组和对象本身也实现依赖收集\n          childOb.dep.depend();\n          //如果值是一个数组的话，还需要对里面的值进行依赖收集\n          //解决多维数组的问题\n          if(Array.isArray(value)){\n            dependArray(value);\n          }\n        }\n      }\n      return value;\n    },\n    set(newVal){\n      //设置值时\n      if(newVal === value) return;\n      //如果设置的值是一个对象时，需要继续对这个对象进行劫持\n      observe(newVal);\n      value = newVal;\n      dep.notify();//设置值的时候通知watcher更新渲染\n    }\n  })\n}\n\n/**收集数组数据的依赖 */\nfunction dependArray(value){\n  for(let i = 0;i < value.length;i++){\n    let current = value[i];\n    current.__ob__ && current.__ob__.dep.depend();\n    if(Array.isArray(current)){\n      dependArray(current);\n    }\n  }\n}","import { observe } from \"./observe\";\nimport Watcher from \"./observe/watcher\";\n\n/**初始化状态 */\nexport function initState(vm){\n  const opts = vm.$options;//获取用户的选项\n  if(opts.data){\n    //初始化数据，生成相应式数据\n    initData(vm);\n  }\n  if(opts.computed){\n    //初始化计算属性\n    initComputed(vm);\n  }\n}\n\n/**初始化数据，生成相应式数据 */\nfunction initData(vm){\n  let data = vm.$options.data;\n  //如果data 是函数还需要先执行才能回去到要劫持的数据\n  data = typeof data === 'function' ? data.call(vm) : data;\n  \n  //进行数据劫持，来创建响应式数据\n  observe(data);\n\n  //为了方便之后访问 data，给实例挂载一个 _data\n  vm._data = data;\n  //但是这样的话就需要使用 vm._data.xxx 来访问，这样不够优雅\n  //所以可以将 vm._data 用vm来代理就可以用 vm.xxx来访问 _data 中的属性了\n  for(let key in data){\n    proxy(vm,'_data',key);\n  }\n}\n\n/**代理 */\nfunction proxy(vm,target,key){\n  Object.defineProperty(vm,key,{\n    get(){\n      return vm[target][key]\n    },\n    set(newVal){\n      vm[target][key] = newVal\n    }\n  })\n}\n\n/**初始化计算属性 */\nfunction initComputed(vm){\n  const computed = vm.$options.computed;\n  for(let key in computed){\n    let userDef = computed[key];\n    //需要一个computed 的 watcher 来维护计算属性，方便实现之后的缓存\n    //需要监控计算属性中的get变化\n    let fn = typeof userDef == 'function' ? userDef : userDef.get;\n    //如果直接new Watcher默认就会执行fn,所以需要添加一个{lazy:true}来\n    new Watcher(vm,fn,{lazy:true});\n\n    defineComputed(vm,key,userDef);\n  }\n}\n\n/**为实例挂载上计算属性 */\nfunction defineComputed(target,key,userDef){\n  //getter可能是一个 function 也可能是对象\n  const getter = typeof userDef == 'function' ? userDef : userDef.get;\n  const setter = userDef.set || (()=>{});\n  //当调用 render 渲染函数的时候，会访问计算属性\n  //计算属性函数调用的时候也会访问data的属性，从未获取到完整的值\n  Object.defineProperty(target,key,{\n    get:getter,\n    set:setter,\n  })\n}","import { compileToFunction } from \"./compiler\";\nimport { callHook, mountComponent } from \"./lifecycle\";\nimport { initState } from \"./state\";\nimport { mergeOptions } from \"./utils\";\n\n/**\n * 初始化函数，就是为Vue添加_init方法\n * @param { Vue构造函数 } Vue \n */\nexport function initMixin(Vue){\n  Vue.prototype._init = function(options){\n    //将 options 挂载到 实例的 $options 上方便后续方法的访问\n    const vm = this;\n    //合并选项并赋值,定义的全局过滤器，指令等都会挂载上去\n    // this 指向Vue实例，在实例上没有constructor，但是会在原型链上查找\n    vm.$options = mergeOptions(this.constructor.options,options);\n    \n    // 调用生命周期函数\n    callHook(vm,\"beforeCreate\");\n    // 初始化状态，计算属性，watch\n    initState(vm);\n    // 调用生命周期函数\n    callHook(vm,\"beforeCreate\");\n\n    // 实现数据的挂载\n    if(options.el){\n      vm.$mount(options.el);\n    }\n  }\n  Vue.prototype.$mount = function(el){\n    const vm = this;\n    el = document.querySelector(el);\n    let opts = vm.$options;\n    //优先级 render > template > el\n    if(!opts.render){//查看是否有render函数\n      // 没有render函数，表示并不是用户自己写的渲染方法\n      // 如果没有template，有el就使用el作为模版，如果有template就使用template\n      let template;\n      if(!opts.template && el){\n        template = el.outerHTML;\n      }else{\n        if(el){//如果有el则采用模版内容\n          template = opts.template;\n        }\n      }\n      if(template){\n        //这里需要对模版进行编译\n        const render = compileToFunction(template);\n        opts.render = render;// jsx 最终会被编译成 h('xxx')\n      }\n    }\n\n    //组件挂载\n    mountComponent(vm,el);\n\n    //最终就可以获取render方法\n\n    // script 标签引用的 vue.global.js 这个编译过程是在浏览器运行的\n    // runtime 是不包含模版编译的，整个编译时打包的时候通过loader来进行转义.vue文件的\n    // 所以用runtime的时候不能使用template\n  }\n}","import { initGlobalAPI } from \"./globalAPI\";\nimport { initMixin } from \"./init\";\nimport { initLifeCycle } from \"./lifecycle\";\nimport { nextTick } from \"./observe/watcher\";\n\n// 不使用 class 来定义Vue 原因是，class会将所有的方法都封装到一起，导致耦合度过大，不便于管理和拆分\nfunction Vue(options){//options 就是用户的选项\n  this._init(options);\n}\n\n// 添加方法\nVue.prototype.$nextTick = nextTick;\ninitMixin(Vue);\ninitLifeCycle(Vue);\ninitGlobalAPI(Vue);\n\nexport default Vue;"],"names":["mergeOptions","parent","child","options","key","mergeField","hasOwnProperty","strats","LIFECYCLE","forEach","hook","p","c","concat","initGlobalAPI","Vue","mixin","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","createASTElement","tag","attrs","type","children","start","node","push","chars","text","replace","end","pop","length","advance","substring","parseStartTag","match","tagName","attr","name","value","textEnd","indexOf","startTagMatch","endTagMatch","genProps","str","i","obj","split","item","JSON","stringify","slice","defaultTagRE","gen","codegen","test","token","lastIndex","exec","index","trim","join","genChildren","map","ast","code","compileToFunction","template","render","Function","id","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","Watcher","vm","fn","renderWatcher","getter","deps","depsId","Set","get","dep","has","add","addSub","queueWatcher","flushSchedulerQueue","flushQueue","queue","pending","q","run","nextTick","flushCallbacks","cbs","callbacks","waiting","cb","timerFunc","Promise","resolve","then","MutationObserver","observer","textNode","document","createTextNode","observe","characterData","textContent","setImmediate","setTimeout","createElementVNode","data","vnode","createTextVNode","undefined","createElm","el","createElement","patchProps","appendChild","props","styleName","style","setAttribute","patch","oldNode","console","log","isRealElement","nodeType","elm","parentElm","parentNode","newElm","insertBefore","nextSibiling","removeChild","initLifeCycle","prototype","_update","$el","_c","arguments","_v","_s","_render","$options","call","mountComponent","updateComponent","callHook","handlers","handler","oldArrayProto","Array","newArrayProto","Object","create","methods","args","result","inserted","ob","__ob__","observeArray","notify","Observer","defineProperty","enumerable","isArray","__proto__","walk","keys","defineReactive","childOb","depend","dependArray","set","newVal","current","initState","opts","initData","computed","initComputed","_data","proxy","userDef","lazy","defineComputed","setter","initMixin","_init","constructor","$mount","querySelector","outerHTML","$nextTick"],"mappings":"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"}